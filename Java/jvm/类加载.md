类加载

在Java代码中，类型（class）的加载，连接和初始化过程都是在程序运行期间完成的。

## class文件的生命周期

1. 加载:类加载器将编译好的二进制文件（class），从磁盘加载到内存;
2. 连接：
   1. 验证：验证加载的字节码文件的正确性；
   2. 准备：为类的<font color=#FF0000 >**静态变量分配内存空间和设置默认值**</font>；
   3. 解析：将类的符号引用转变为直接引用
3. 初始化：为类的静态变量赋予<font color=#FF0000 >**正确的初始值**</font>
4. 使用：创建对象等操作；
5. 卸载：不在使用该类，从内存中去除。

> java程序对类的使用可以分为两种
>
> - 主动使用
> - 被动使用
>
> 所有的java虚拟机实现必须在每个类或者及接口被java程序<font color=#FF0000 >**首次主动使用**</font>时，才初始化。

​    

### 主动使用

1. 创建类的实例（new对象操作）；
2. 调用类和接口的静态变量，或者给静态变量赋值；
3. 调用的类的静态方法;
4. 反射（class.foName("com.test.Test")）;
5. 初始化一个类的子类（子类的父类全部会被初始化）；
6. JVM启动时被标记为启动类的类（包含main方法类）；
7. JDK1.7开始提供的动态语言支持（Jsp文件）

## 类的加载

类的加载是将类.class文件中的<font color=#FF0000 >**二进制数据读取到内存空间**</font>，放在<font color=#FF0000 >**运行时的数据区的方法区中**</font>，然后<font color=#FF0000 >**创建一个java.lang.Class对象用来封装类在方法区的数据结构**</font>（JVM虚拟机规范并未说明class对象放在哪里，HotSpot将其放在方法区）。

### 类加载的方式

- 从本地系统中直接加载；
- 通过网络下载的.class文件；
- 从zip，jar等归档文件中加载
- 从专有的数据库文件加载
- 将java源代码动态的编译为class文件